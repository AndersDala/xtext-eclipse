<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" >
	<title>Web Editor Support</title>
	<link href="book.css" rel="stylesheet" type="text/css">
	<link href="code.css" rel="stylesheet" type="text/css">
	<link rel="home" href="index.html" title="">
</head>
<body>
<!-- Google Tag Manager -->
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-TGDS5S"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-TGDS5S');</script>
<!-- End Google Tag Manager -->

<h1 id="web-integration">Web Editor Support</h1>

<p>Since version 2.9 Xtext offers an interface for integration of text editors in web applications. The text editors are implemented in JavaScript, and language-related services such as code completion are realized through HTTP requests to a server-side component.</p>

<h2 id="client">The Client</h2>

<p>Xtext supports three JavaScript text editor libraries:</p>

<ul>
  <li><a href="http://eclipse.org/orion/">Orion</a></li>
  <li><a href="http://ace.c9.io">Ace</a></li>
  <li><a href="http://codemirror.net">CodeMirror</a></li>
</ul>

<p>The set of supported language-related services depends on which editor library is chosen, as shown in the following table.</p>

<table class="table table-bordered">
  <thead>
    <tr>
      <th></th>
      <th>Orion</th>
      <th>Ace</th>
      <th>CodeMirror</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><a href="#content-assist">Content assist</a></td>
      <td><div class="supported"></div></td>
      <td><div class="supported"></div></td>
      <td><div class="supported"></div></td>
    </tr>
    <tr>
      <td><a href="303_runtime_concepts.html#validation">Validation</a></td>
      <td><div class="supported"></div></td>
      <td><div class="supported"></div></td>
      <td><div class="supported"></div></td>
    </tr>
    <tr>
      <td><a href="#syntax-highlighting">Syntax highlighting</a></td>
      <td><div class="supported"></div></td>
      <td><div class="supported"></div></td>
      <td><div class="supported"></div></td>
    </tr>
    <tr>
      <td><a href="#semantic-highlighting">Semantic highlighting</a></td>
      <td><div class="supported"></div></td>
      <td><div class="not-supported"></div></td>
      <td><div class="supported"></div></td>
    </tr>
    <tr>
      <td><a href="#mark-occurrences">Mark occurrences</a></td>
      <td><div class="supported"></div></td>
      <td><div class="supported"></div></td>
      <td><div class="supported"></div></td>
    </tr>
    <tr>
      <td><a href="#hover-info">Hover information</a></td>
      <td><div class="supported"></div></td>
      <td><div class="not-supported"></div></td>
      <td><div class="not-supported"></div></td>
    </tr>
    <tr>
      <td><a href="303_runtime_concepts.html#formatting">Formatting</a></td>
      <td><div class="supported"></div></td>
      <td><div class="supported"></div></td>
      <td><div class="supported"></div></td>
    </tr>
    <tr>
      <td><a href="303_runtime_concepts.html#code-generation">Code generator</a></td>
      <td><div class="supported"></div></td>
      <td><div class="supported"></div></td>
      <td><div class="supported"></div></td>
    </tr>
    <tr>
      <td><a href="#persistence">Persistence</a></td>
      <td><div class="supported"></div></td>
      <td><div class="supported"></div></td>
      <td><div class="supported"></div></td>
    </tr>
  </tbody>
</table>

<p>The JavaScript integration of Xtext uses <a href="http://requirejs.org">RequireJS</a> for managing modules and their dependencies. The main module is <code class="highlighter-rouge">xtext/xtext-orion</code>, <code class="highlighter-rouge">xtext/xtext-ace</code>, or <code class="highlighter-rouge">xtext/xtext-codemirror</code>, depending on which editor library is used. Examples for loading these libraries together with Xtext can be generated by the <code class="highlighter-rouge">WebIntegrationFragment</code> by setting the option <code class="highlighter-rouge">generateHtmlExample = true</code> (see <a href="302_configuration.html#generator">The Language Generator</a>). A minimal setup based on <a href="http://webjars.org">WebJars</a> is shown in the following listings.</p>

<h4 id="orion">Orion</h4>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">require</span><span class="p">.</span><span class="nx">config</span><span class="p">({</span>
    <span class="na">paths</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"text"</span><span class="p">:</span> <span class="s2">"webjars/requirejs-text/&lt;version&gt;/text"</span><span class="p">,</span>
        <span class="s2">"jquery"</span><span class="p">:</span> <span class="s2">"webjars/jquery/&lt;version&gt;/jquery.min"</span><span class="p">,</span>
        <span class="s2">"xtext/xtext-orion"</span><span class="p">:</span> <span class="s2">"xtext/&lt;version&gt;/xtext-orion"</span>
    <span class="p">}</span>
<span class="p">});</span>
<span class="nx">require</span><span class="p">([</span><span class="s2">"orion/code_edit/built-codeEdit-amd"</span><span class="p">],</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">require</span><span class="p">([</span><span class="s2">"xtext/xtext-orion"</span><span class="p">],</span> <span class="kd">function</span><span class="p">(</span><span class="nx">xtext</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">xtext</span><span class="p">.</span><span class="nx">createEditor</span><span class="p">();</span>
    <span class="p">});</span>
<span class="p">});</span>
</code></pre>
</div>
<p>Since Orion is not available on WebJars, it has to be downloaded manually at <a href="http://download.eclipse.org/orion/">download.eclipse.org</a>.</p>

<h4 id="ace">Ace</h4>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">require</span><span class="p">.</span><span class="nx">config</span><span class="p">({</span>
    <span class="na">paths</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"jquery"</span><span class="p">:</span> <span class="s2">"webjars/jquery/&lt;version&gt;/jquery.min"</span><span class="p">,</span>
        <span class="s2">"ace/ext/language_tools"</span><span class="p">:</span> <span class="s2">"webjars/ace/&lt;version&gt;/src/ext-language_tools"</span><span class="p">,</span>
        <span class="s2">"xtext/xtext-ace"</span><span class="p">:</span> <span class="s2">"xtext/&lt;version&gt;/xtext-ace"</span>
    <span class="p">}</span>
<span class="p">});</span>
<span class="nx">require</span><span class="p">([</span><span class="s2">"webjars/ace/&lt;version&gt;/src/ace"</span><span class="p">],</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">require</span><span class="p">([</span><span class="s2">"xtext/xtext-ace"</span><span class="p">],</span> <span class="kd">function</span><span class="p">(</span><span class="nx">xtext</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">xtext</span><span class="p">.</span><span class="nx">createEditor</span><span class="p">();</span>
    <span class="p">});</span>
<span class="p">});</span>
</code></pre>
</div>

<h4 id="codemirror">CodeMirror</h4>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">require</span><span class="p">.</span><span class="nx">config</span><span class="p">({</span>
    <span class="na">paths</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"jquery"</span><span class="p">:</span> <span class="s2">"webjars/jquery/&lt;version&gt;/jquery.min"</span><span class="p">,</span>
        <span class="s2">"xtext/xtext-codemirror"</span><span class="p">:</span> <span class="s2">"xtext/&lt;version&gt;/xtext-codemirror"</span>
    <span class="p">},</span>
    <span class="na">packages</span><span class="p">:</span> <span class="p">[{</span>
        <span class="na">name</span><span class="p">:</span> <span class="s2">"codemirror"</span><span class="p">,</span>
        <span class="na">location</span><span class="p">:</span> <span class="s2">"webjars/codemirror/&lt;version&gt;"</span><span class="p">,</span>
        <span class="na">main</span><span class="p">:</span> <span class="s2">"lib/codemirror"</span>
    <span class="p">}]</span>
<span class="p">});</span>
<span class="nx">require</span><span class="p">([</span><span class="s2">"xtext/xtext-codemirror"</span><span class="p">],</span> <span class="kd">function</span><span class="p">(</span><span class="nx">xtext</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">xtext</span><span class="p">.</span><span class="nx">createEditor</span><span class="p">();</span>
<span class="p">});</span>
</code></pre>
</div>

<h3 id="javascript-api">JavaScript API</h3>

<h4 id="xtextcreateeditoroptions"><code class="highlighter-rouge">xtext.createEditor(options)</code></h4>

<p>Creates one or more editor instances and initializes Xtext services for them. The available options are described below. The return value is the created editor if exactly one was created, or an array of editors otherwise:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">editor</span> <span class="o">=</span> <span class="nx">xtext</span><span class="p">.</span><span class="nx">createEditor</span><span class="p">();</span>
</code></pre>
</div>

<p>For Orion the editor is not returned directly, but through a <em>promise</em>:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">xtext</span><span class="p">.</span><span class="nx">createEditor</span><span class="p">().</span><span class="nx">done</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">editorViewer</span><span class="p">)</span> <span class="p">{</span>
    <span class="p">...</span>
<span class="p">});</span>
</code></pre>
</div>

<p>If the parent element for the editor is not specified through the options, this function looks for an element with <code class="highlighter-rouge">id="xtext-editor"</code>. If none exists, the function looks for elements with <code class="highlighter-rouge">class="xtext-editor"</code>.</p>

<h4 id="xtextcreateserviceseditor-options"><code class="highlighter-rouge">xtext.createServices(editor, options)</code></h4>

<p>Initializes Xtext services for an already created editor. Use this variant if you want full control over the editor creation.</p>

<h4 id="xtextremoveserviceseditor"><code class="highlighter-rouge">xtext.removeServices(editor)</code></h4>

<p>Removes all services and associated listeners from the given editor. The JavaScript-based syntax highlighting is not affected by this operation.</p>

<h3 id="options">Options</h3>

<p>Options can be specified with an object passed to the <code class="highlighter-rouge">createEditor</code> or <code class="highlighter-rouge">createServices</code> functions:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="nx">xtext</span><span class="p">.</span><span class="nx">createEditor</span><span class="p">({</span>
    <span class="na">resourceId</span><span class="p">:</span> <span class="s2">"example.statemachine"</span><span class="p">,</span>
    <span class="na">syntaxDefinition</span><span class="p">:</span> <span class="s2">"xtext/ace-mode-statemachine"</span>
<span class="p">});</span>
</code></pre>
</div>

<p>Alternatively, if <code class="highlighter-rouge">createEditor</code> is used, options can be set as attributes of the HTML element into which the editor is created. The attribute name is derived from the JavaScript option name by converting CamelCase to hyphen-separated and prefixing with <code class="highlighter-rouge">data-editor-</code>, e.g. <code class="highlighter-rouge">resourceId</code> becomes <code class="highlighter-rouge">data-editor-resource-id</code>:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"xtext-editor"</span>
    <span class="na">data-editor-resource-id=</span><span class="s">"example.statemachine"</span>
    <span class="na">data-editor-syntax-definition=</span><span class="s">"xtext/ace-mode-statemachine"</span><span class="nt">&gt;&lt;/div&gt;</span>
</code></pre>
</div>

<p>See below for a <a href="#options-reference">full list of available options</a>.</p>

<h3 id="getting-text-content">Getting the Text Content</h3>

<p>The text content is either loaded from the Xtext server or provided through JavaScript. In either case, the Xtext server needs to identify the language you are using in order to process any requests. A language is usually identified using a file extension or a content type. The file extension can be specified with the <code class="highlighter-rouge">xtextLang</code> option, while the content type is given with the <code class="highlighter-rouge">contentType</code> option.</p>

<h4 id="loading-text-from-the-server">Loading text from the server</h4>

<p>If you specify a value for the <code class="highlighter-rouge">resourceId</code> option, the language may be identified from the file extension included in that id. In this case it is not necessary to provide the <code class="highlighter-rouge">xtextLang</code> option. Another effect of using <code class="highlighter-rouge">resourceId</code> is that the server will try to load the respective resource from its persistence layer. The Xtext server does not define any default persistence, so you have to customize it as described in <a href="#persistence">Persistence</a> in order to use this approach.</p>

<p>The <code class="highlighter-rouge">resourceId</code> string may contain whatever information you need to identify a specific text content on the server. Usually the <a href="https://en.wikipedia.org/wiki/Uniform_Resource_Identifier">URI</a> syntax is used, but this is not mandatory.</p>

<h4 id="providing-text-through-javascript">Providing text through JavaScript</h4>

<p>The persistence layer of the Xtext server is totally optional, so you can use whatever means you like to fetch the content, e.g. generate it in the client or request it through your own service. If the DOM element into which the editor is created already contains some text, this text is used as initial content. Otherwise the editor is initially empty, and you can use the API of the chosen editor framework to change the content whenever you like.</p>

<p>If you would like to specify a <code class="highlighter-rouge">resourceId</code> without using the persistence services shipped with Xtext, you can do so by setting the option <code class="highlighter-rouge">loadFromServer</code> to <code class="highlighter-rouge">false</code>.</p>

<h3 id="operation-modes">Operation Modes</h3>

<p>The web integration of Xtext supports two operation modes, which are described in the following.</p>

<h4 id="stateful-mode">Stateful mode</h4>

<p>This mode is active when <code class="highlighter-rouge">sendFullText</code> is <code class="highlighter-rouge">false</code>, which is the default setting. In stateful mode, an update request is sent to the server whenever the text content of the editor changes. With this approach a copy of the text is kept in the session state of the server, and many Xtext-related services such as AST parsing and validation are cached together with that copy. This means that services run much faster on the server, and the message size of most requests is very small. Use this mode in order to optimize response times of service requests.</p>

<h4 id="stateless-mode">Stateless mode</h4>

<p>This mode is active when <code class="highlighter-rouge">sendFullText</code> is set to <code class="highlighter-rouge">true</code>. In this case no update request is necessary when the text content changes, but the full text content is attached to all other service requests. This means that the text has to be parsed again for each request, and the message size is proportional to the size of the text content. Use this mode only when you want to avoid server-side sessions and respective session ids stored in cookies.</p>

<h3 id="syntax-highlighting">Syntax Highlighting</h3>

<p>In contrast to <a href="#semantic-highlighting">semantic highlighting</a>, syntax highlighting can be computed purely in JavaScript without requiring a connection to the server. This is realized with the highlighting capabilities of the employed editor libraries. All three libraries offer a JavaScript API for specifying highlighting rules. The <code class="highlighter-rouge">WebIntegrationFragment</code> of the Xtext language generator is able to generate a highlighting specification that includes keywords and some basic tokens such as numbers and comments (see <a href="302_configuration.html#generator">The Language Generator</a>). If the highlighting generated in this way is not sufficient, you can still implement the specification yourself following the documentation of the chosen editor library.</p>

<p>The path to the highlighting specification is set with the <code class="highlighter-rouge">syntaxDefinition</code> option while setting up the Xtext editor. If no value is specified for that option, it is built from the <code class="highlighter-rouge">xtextLang</code> option in the form <code class="highlighter-rouge">'xtext-resources/{xtextLang}-syntax'</code> (Orion) or <code class="highlighter-rouge">'xtext-resources/mode-{xtextLang}'</code> (Ace). For CodeMirror syntax highlighting is configured by registering a <em>mode</em> and setting the <code class="highlighter-rouge">mode</code> option accordingly (default mode name: <code class="highlighter-rouge">'xtext/{xtextLang}'</code>).</p>

<h3 id="invoking-services">Invoking Services</h3>

<p>The <code class="highlighter-rouge">createEditor</code> and <code class="highlighter-rouge">createServices</code> functions set up listeners for editor events such that most services are invoked automatically while using the editor. However, all services can also be invoked programmatically using the <code class="highlighter-rouge">xtextServices</code> object that is attached to each editor instance. For example, the following code saves the resource associated with the editor when the button with the id <code class="highlighter-rouge">save-button</code> is clicked:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">editor</span> <span class="o">=</span> <span class="nx">xtext</span><span class="p">.</span><span class="nx">createEditor</span><span class="p">();</span>
<span class="nx">$</span><span class="p">(</span><span class="s2">"#save-button"</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">editor</span><span class="p">.</span><span class="nx">xtextServices</span><span class="p">.</span><span class="nx">saveResource</span><span class="p">();</span>
<span class="p">});</span>
</code></pre>
</div>

<p>The following functions are available, provided that the respective services are enabled and supported by the employed editor library. All functions return a <em>promise</em> that is eventually resolved to the requested data. Furthermore, all these functions can be supplied with an <code class="highlighter-rouge">options</code> parameter to override some of the options declared when the editor was built.</p>

<ul>
  <li><code class="highlighter-rouge">getContentAssist()</code>
Returns the content assist proposals in the format explained in Section <a href="#content-assist">Content Assist</a>.</li>
  <li><code class="highlighter-rouge">validate()</code>
Returns the validation result. The returned object has a property <code class="highlighter-rouge">issues</code>, which is an array of objects with the following properties:
    <ul>
      <li><code class="highlighter-rouge">description</code>: A description to be displayed to the user.</li>
      <li><code class="highlighter-rouge">severity</code>: one of <code class="highlighter-rouge">'error'</code>, <code class="highlighter-rouge">'warning'</code>, or <code class="highlighter-rouge">'info'</code></li>
      <li><code class="highlighter-rouge">line</code>: the line where the issue occurs (one-based)</li>
      <li><code class="highlighter-rouge">column</code>: the column where the issue occurs (one-based)</li>
      <li><code class="highlighter-rouge">offset</code>: the character offset in the document (zero-based)</li>
      <li><code class="highlighter-rouge">length</code>: the length of the affected text region</li>
    </ul>
  </li>
  <li><code class="highlighter-rouge">computeHighlighting()</code>
Returns the text styling data for semantic highlighting (see Section <a href="#semantic-highlighting">Semantic Highlighting</a>).</li>
  <li><code class="highlighter-rouge">getOccurrences()</code>
Returns the occurrences of the element at the current cursor position (see Section <a href="#mark-occurrences">Mark Occurrences</a>).</li>
  <li><code class="highlighter-rouge">getHoverInfo()</code>
Returns the hover information at the current cursor position (see Section <a href="#hover-info">Hover Information</a>).</li>
  <li><code class="highlighter-rouge">format()</code>
Formats the current selection (or the whole document if the selection has zero length) and returns the formatted text.</li>
  <li><code class="highlighter-rouge">generate()</code>
Returns the document generated from the associated resource. If more than one document has been generated, an object with a property <code class="highlighter-rouge">documents</code> is returned, which is an array of objects with the properties <code class="highlighter-rouge">name</code>, <code class="highlighter-rouge">contentType</code>, and <code class="highlighter-rouge">content</code>.</li>
  <li><code class="highlighter-rouge">loadResource()</code>
Loads the associated resource and returns an object with properties <code class="highlighter-rouge">fullText</code> and <code class="highlighter-rouge">dirty</code>. If the resource has been modified during the current session, the modified version is returned even if the page is reloaded.</li>
  <li><code class="highlighter-rouge">saveResource()</code>
Saves the current state of the resource.</li>
  <li><code class="highlighter-rouge">revertResource()</code>
Reverts the resource to the last saved state and returns an object with properties <code class="highlighter-rouge">fullText</code> and <code class="highlighter-rouge">dirty</code>.</li>
  <li><code class="highlighter-rouge">update()</code>
Computes the difference between the current editor content and the last version that has been committed to the server. If there is a difference, an update request is sent to refresh the server state. The return value has a single property <code class="highlighter-rouge">stateId</code>, which is an identifier for the new server state. All requests have to include the last obtained state identifier in order to suceed.</li>
</ul>

<h3 id="options-reference">Full List of Options</h3>

<ul>
  <li><code class="highlighter-rouge">baseUrl</code>
The path segment where the Xtext service is found (default: <code class="highlighter-rouge">'/'</code>). See the <code class="highlighter-rouge">serviceUrl</code> option.</li>
  <li><code class="highlighter-rouge">contentAssistCharTriggers</code>
Characters that invoke the content assist service when typed (Orion only).</li>
  <li><code class="highlighter-rouge">contentAssistExcludedStyles</code>
Excluded styles for character triggers (Orion only).</li>
  <li><code class="highlighter-rouge">contentType</code>
The content type included in requests to the Xtext server. If no content type is given, the file extension in the <code class="highlighter-rouge">resourceId</code> option is used to determine the language.</li>
  <li><code class="highlighter-rouge">dirtyElement</code>
An element into which the dirty status class is written when the editor is marked dirty; it can be either a DOM element or an id for a DOM element.</li>
  <li><code class="highlighter-rouge">dirtyStatusClass</code>
A CSS class name written into the dirtyElement when the editor is marked dirty (default: <code class="highlighter-rouge">'dirty'</code>).</li>
  <li><code class="highlighter-rouge">document</code>
The document; if not specified, the global document is used.</li>
  <li><code class="highlighter-rouge">enableContentAssistService</code>
Whether content assist should be enabled (default: <code class="highlighter-rouge">true</code>).</li>
  <li><code class="highlighter-rouge">enableFormattingAction</code>
Whether the formatting action should be bound to the standard keystroke Ctrl+Shift+F / Cmd+Shift+F (default: <code class="highlighter-rouge">false</code>).</li>
  <li><code class="highlighter-rouge">enableFormattingService</code>
Whether text formatting should be enabled (default: <code class="highlighter-rouge">true</code>).</li>
  <li><code class="highlighter-rouge">enableGeneratorService</code>
Whether code generation should be enabled (default: <code class="highlighter-rouge">true</code>). No default keystroke is bound for the generator, so it must be triggered through JavaScript code.</li>
  <li><code class="highlighter-rouge">enableHoverService</code>
Whether mouse hover information should be enabled (default: <code class="highlighter-rouge">true</code>).</li>
  <li><code class="highlighter-rouge">enableHighlightingService</code>
Whether semantic highlighting should be enabled (default: <code class="highlighter-rouge">true</code>). In contrast to <a href="#syntax-highlighting">syntax highlighting</a>, semantic highlighting is computed on the server.</li>
  <li><code class="highlighter-rouge">enableOccurrencesService</code>
Whether marking occurrences should be enabled (default: <code class="highlighter-rouge">true</code>).</li>
  <li><code class="highlighter-rouge">enableSaveAction</code>
Whether the save action should be bound to the standard keystroke Ctrl+S / Cmd+S (default: <code class="highlighter-rouge">false</code>).</li>
  <li><code class="highlighter-rouge">enableValidationService</code>
Whether validation should be enabled (default: <code class="highlighter-rouge">true</code>).</li>
  <li><code class="highlighter-rouge">loadFromServer</code>
Whether to load the editor content from the server. The default value is <code class="highlighter-rouge">true</code> if the <code class="highlighter-rouge">resourceId</code> option is set and <code class="highlighter-rouge">false</code> otherwise.</li>
  <li><code class="highlighter-rouge">mouseHoverDelay</code>
The number of milliseconds to wait after a mouse hover before the information tooltip is displayed (default: 500).</li>
  <li><code class="highlighter-rouge">parent</code>
The parent element into which the editor should be created. It can be either a DOM element or an id for a DOM element (default: <code class="highlighter-rouge">'xtext-editor'</code>).</li>
  <li><code class="highlighter-rouge">parentClass</code>
If the <code class="highlighter-rouge">parent</code> option is not given, this option is used to find elements that match the given class name (default: <code class="highlighter-rouge">'xtext-editor'</code>).</li>
  <li><code class="highlighter-rouge">resourceId</code>
The identifier of the resource displayed in the text editor. This option is sent to the server to communicate required information on the respective resource.</li>
  <li><code class="highlighter-rouge">selectionUpdateDelay</code>
The number of milliseconds to wait after a selection change before Xtext services are invoked (default: 550).</li>
  <li><code class="highlighter-rouge">sendFullText</code>
Whether the full text shall be sent to the server with each request (default: <code class="highlighter-rouge">false</code>). Use this if you want the server to run in stateless mode. If the option is inactive, the server state is updated regularly.</li>
  <li><code class="highlighter-rouge">serviceUrl</code>
The URL of the Xtext servlet. If no value is given, it is constructed using the <code class="highlighter-rouge">baseUrl</code> option in the form <code class="highlighter-rouge"><span class="p">{</span><span class="err">location.protocol</span><span class="p">}</span><span class="err">//</span><span class="p">{</span><span class="err">location.host</span><span class="p">}{</span><span class="err">baseUrl</span><span class="p">}</span><span class="err">xtext-service</span></code>.</li>
  <li><code class="highlighter-rouge">showErrorDialogs</code>
Whether errors should be displayed in popup dialogs (default: <code class="highlighter-rouge">false</code>).</li>
  <li><code class="highlighter-rouge">syntaxDefinition</code>
A path to a JS file containing a syntax definition. Set this option to <code class="highlighter-rouge">'none'</code> to disable syntax highlighting. See <a href="#syntax-highlighting">Syntax Highlighting</a> for more details.</li>
  <li><code class="highlighter-rouge">textUpdateDelay</code>
The number of milliseconds to wait after a text change before Xtext services are invoked (default: 500).</li>
  <li><code class="highlighter-rouge">xtextLang</code>
The language name (usually the file extension configured for the language). This is used to set the <code class="highlighter-rouge">resourceId</code> and <code class="highlighter-rouge">syntaxDefinition</code> options if they have not been specified.</li>
</ul>

<h2 id="server">The Server</h2>

<p>The language-specific resources are provided through HTTP requests which are processed by the <a href="https://github.com/eclipse/xtext/blob/v2.9.0/web/org.eclipse.xtext.web.servlet/src/main/java/org/eclipse/xtext/web/servlet/XtextServlet.xtend">XtextServlet</a>. This class is also responsible for managing the lifecycle of the language <a href="https://google.github.io/guice/api-docs/latest/javadoc/com/google/inject/Injector.html">Injector</a> (see <a href="302_configuration.html#dependency-injection">Dependency Injection</a>). The default approach is to create an injector when the servlet is started and to register it in the <a href="https://github.com/eclipse/xtext/blob/v2.9.0/plugins/org.eclipse.xtext/src/org/eclipse/xtext/resource/IResourceServiceProvider.java">IResourceServiceProvider.Registry</a>. In order to override default behavior, you can change or add bindings in the <code class="highlighter-rouge">&lt;LanguageName&gt;WebModule</code> of your language.</p>

<p>The usual way to include the Xtext servlet in a server application is to create a subclass of <a href="https://github.com/eclipse/xtext/blob/v2.9.0/web/org.eclipse.xtext.web.servlet/src/main/java/org/eclipse/xtext/web/servlet/XtextServlet.xtend">XtextServlet</a>, override <code class="highlighter-rouge">init()</code> and <code class="highlighter-rouge">destroy()</code> to manage the runtime resources, and add a <a href="https://docs.oracle.com/javaee/7/api/javax/servlet/annotation/WebServlet.html">WebServlet</a> annotation with <code class="highlighter-rouge">urlPatterns = "/xtext-service/*"</code> as parameter. See <a href="https://github.com/eclipse/xtext/blob/v2.9.0/web/org.eclipse.xtext.web.example.jetty/src/main/java/org/eclipse/xtext/web/example/jetty/MyXtextServlet.xtend">MyXtextServlet</a> for an example.</p>

<p>If you want to implement your own communication channel to provide the language-specific services without using XtextServlet, you can do so by injecting an instance of <a href="https://github.com/eclipse/xtext/blob/v2.9.0/web/org.eclipse.xtext.web/src/main/java/org/eclipse/xtext/web/server/XtextServiceDispatcher.xtend">XtextServiceDispatcher</a> and calling <code class="highlighter-rouge">getService(IServiceContext)</code>. The input to this method is an <a href="https://github.com/eclipse/xtext/blob/v2.9.0/web/org.eclipse.xtext.web/src/main/java/org/eclipse/xtext/web/server/IServiceContext.xtend">IServiceContext</a>, which must be implemented to provide the request parameters and the client session. The return value is a descriptor that can be used to invoke the actual service. Furthermore, <a href="https://github.com/eclipse/xtext/blob/v2.9.0/web/org.eclipse.xtext.web/src/main/java/org/eclipse/xtext/web/server/XtextServiceDispatcher.xtend">XtextServiceDispatcher</a> can be subclassed in order to add custom services with access to the document AST and all related Xtext APIs.</p>

<p>The following sections describe how to customize the standard services for web editors.</p>

<h3 id="content-assist">Content Assist</h3>

<p>Content assist proposals for cross-references are created by <a href="https://github.com/eclipse/xtext/blob/v2.9.0/plugins/org.eclipse.xtext.ide/src/org/eclipse/xtext/ide/editor/contentassist/IdeCrossrefProposalProvider.xtend">IdeCrossrefProposalProvider</a>, while for other grammar elements <a href="https://github.com/eclipse/xtext/blob/v2.9.0/plugins/org.eclipse.xtext.ide/src/org/eclipse/xtext/ide/editor/contentassist/IdeContentProposalProvider.xtend">IdeContentProposalProvider</a> is used. In order to customize the proposals, create subclasses of these providers and register them in your web Guice module.</p>

<p><a href="https://github.com/eclipse/xtext/blob/v2.9.0/plugins/org.eclipse.xtext.ide/src/org/eclipse/xtext/ide/editor/contentassist/IdeContentProposalProvider.xtend">IdeContentProposalProvider</a> has one <code class="highlighter-rouge">_createProposals(...)</code> dispatch method for each type of grammar element. In most cases the best choice is to override the method for <a href="https://github.com/eclipse/xtext/blob/v2.9.0/plugins/org.eclipse.xtext/emf-gen/org/eclipse/xtext/Assignment.java">Assignments</a> and to filter the correct assignments by comparing them with the instances in the generated GrammarAccess of your language. A proposal is submitted by creating and configuring an instance of <a href="https://github.com/eclipse/xtext/blob/v2.9.0/plugins/org.eclipse.xtext.ide/src/org/eclipse/xtext/ide/editor/contentassist/ContentAssistEntry.xtend">ContentAssistEntry</a> and passing it to the given acceptor. This entry class contains all information required to display the proposal in the web browser and to apply it to the document. Usually it is sent to the client in JSON format.</p>

<p>The typical customization point for <a href="https://github.com/eclipse/xtext/blob/v2.9.0/plugins/org.eclipse.xtext.ide/src/org/eclipse/xtext/ide/editor/contentassist/IdeCrossrefProposalProvider.xtend">IdeCrossrefProposalProvider</a> is the method <code class="highlighter-rouge">createProposal(...)</code>, which is called for each element found by the scope provider. Here you can fine-tune the information to put into the <a href="https://github.com/eclipse/xtext/blob/v2.9.0/plugins/org.eclipse.xtext.ide/src/org/eclipse/xtext/ide/editor/contentassist/ContentAssistEntry.xtend">ContentAssistEntry</a>.</p>

<h3 id="semantic-highlighting">Semantic Highlighting</h3>

<p>The default behavior of Xtext editors is to have no semantic highlighting (syntactic highlighting, e.g. for keywords and strings, is done on the client side as described in <a href="#syntax-highlighting">Syntax Highlighting</a>). In order to add styling to your text, create a subclass of <a href="https://github.com/eclipse/xtext/blob/v2.9.0/plugins/org.eclipse.xtext.ide/src/org/eclipse/xtext/ide/editor/syntaxcoloring/DefaultSemanticHighlightingCalculator.java">DefaultSemanticHighlightingCalculator</a> and override <code class="highlighter-rouge">highlightElement(...)</code>. Here you can mark text regions with CSS classes by submitting a text offset, a length, and the CSS class name to the given acceptor. You can specify the actual text style in a CSS file that is included by the web page containing the Xtext editor.</p>

<h3 id="mark-occurrences">Mark Occurrences</h3>

<p>The service for marking occurrences of a selected element is handled by <a href="https://github.com/eclipse/xtext/blob/v2.9.0/web/org.eclipse.xtext.web/src/main/java/org/eclipse/xtext/web/server/occurrences/OccurrencesService.xtend">OccurrencesService</a>. Here you can override <code class="highlighter-rouge">filter(EObject)</code> to exclude some elements from this service. The actual text regions to be marked are computed automatically from the cross-references present in the model.</p>

<h3 id="hover-info">Hover Information</h3>

<p>The information displayed for mouse hover popups is created in HTML format and consists of two parts: a title and a description.</p>

<p>The title is composed of a text label and an image. The label is computed by <a href="https://github.com/eclipse/xtext/blob/v2.9.0/plugins/org.eclipse.xtext.ide/src/org/eclipse/xtext/ide/labels/INameLabelProvider.xtend">INameLabelProvider</a>, and the default is the value of the <code class="highlighter-rouge">name</code> property of an element, if it exists. The image is determined by an implementation of <a href="https://github.com/eclipse/xtext/blob/v2.9.0/plugins/org.eclipse.xtext.ide/src/org/eclipse/xtext/ide/labels/IImageDescriptionProvider.xtend">IImageDescriptionProvider</a>. The default behavior is to generate a <code class="highlighter-rouge">&lt;div&gt;</code> and annotate it with a CSS class of the form <code class="highlighter-rouge">&lt;class&gt;-icon</code>, where <code class="highlighter-rouge">&lt;class&gt;</code> is the name of the EClass of the corresponding element. The actual images can be assigned to these classes in a CSS file using the <code class="highlighter-rouge">background-image</code> CSS property.</p>

<p>The description part of the hover popup is determined by the <a href="https://github.com/eclipse/xtext/blob/v2.9.0/plugins/org.eclipse.xtext/src/org/eclipse/xtext/documentation/IEObjectDocumentationProvider.java">IEObjectDocumentationProvider</a>. For this part the default content is fetched from the comments in the document: if the definition of the element is preceded by a multi-line comment (e.g. <code class="highlighter-rouge">/* ... */</code>), the content of that comment is used as description.</p>

<h3 id="persistence">Persistence</h3>

<p>Without further adaptation the Xtext server does not provide any persistence functionality. As described in <a href="#getting-text-content">Getting the Text Content</a>, there are multiple ways to fill the web editor with text. If you would like to use the persistence service included in the Xtext server, you need to implement <a href="https://github.com/eclipse/xtext/blob/v2.9.0/web/org.eclipse.xtext.web/src/main/java/org/eclipse/xtext/web/server/persistence/IServerResourceHandler.xtend">IServerResourceHandler</a>. The <code class="highlighter-rouge">get</code> and <code class="highlighter-rouge">put</code> operations declared in that interface should delegate to the persistence layer you would like to connect. For a simple example see <a href="https://github.com/eclipse/xtext/blob/v2.9.0/web/org.eclipse.xtext.web/src/main/java/org/eclipse/xtext/web/server/persistence/FileResourceHandler.xtend">FileResourceHandler</a>.</p>

<hr />

<p><strong><a href="350_continuous_integration.html">Next Chapter: Continuous Integration</a></strong></p>


</body>
</html>
